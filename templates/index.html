<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–°—Ç—Ä–æ–π–º–∞—Ç–µ—Ä–∏–∞–ª—ã</title>
    <link rel="stylesheet" href="/static/style.css?v=20">
</head>

<body>

<header>
    –ú–∞—Å—Ç–µ—Ä–æ–∫
</header>

<!-- ===== CART BUTTON ===== -->
<div id="cartCount">üõí –ö–æ—Ä–∑–∏–Ω–∞ (0)</div>

<!-- ===== CATALOG ===== -->
<section>
    <h2>–ö–∞—Ç–∞–ª–æ–≥</h2>

    <div class="products">
        {% for p in products %}
        <div class="product">
            <h3>{{ p.name }}</h3>
            <p>–¶–µ–Ω–∞: {{ p.price }} ‚ÇΩ</p>
            <button
                class="buy-btn"
                data-name="{{ p.name }}"
                data-price="{{ p.price }}"
            >
                –ö—É–ø–∏—Ç—å
            </button>
        </div>
        {% endfor %}
    </div>
</section>

<!-- ===== CART MODAL ===== -->
<div id="cartModal" class="cart-modal">
    <div class="cart-content">
        <h3>–ö–æ—Ä–∑–∏–Ω–∞</h3>
        <ul id="cartItems"></ul>

        <button id="orderBtn">–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑</button>
        <button id="clearBtn">–û—á–∏—Å—Ç–∏—Ç—å</button>
        <button id="closeCartBtn">–ó–∞–∫—Ä—ã—Ç—å</button>
    </div>
</div>

<!-- ===== ORDER MODAL ===== -->
<div id="orderModal" class="cart-modal">
    <div class="cart-content">
        <h3>–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞</h3>
        <input type="text" id="orderName" placeholder="–í–∞—à–µ –∏–º—è">
        <input type="text" id="orderPhone" placeholder="–¢–µ–ª–µ—Ñ–æ–Ω">

        <button id="sendOrderBtn">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞–∫–∞–∑</button>
        <button id="closeOrderBtn">–û—Ç–º–µ–Ω–∞</button>
    </div>
</div>

<!-- ===== SCRIPT ===== -->
<script>
document.addEventListener("DOMContentLoaded", () => {

    /* ===== STATE ===== */
    let cart = JSON.parse(localStorage.getItem("cart")) || [];

    const cartCount = document.getElementById("cartCount");
    const cartModal = document.getElementById("cartModal");
    const orderModal = document.getElementById("orderModal");
    const cartItems = document.getElementById("cartItems");

    /* ===== HELPERS ===== */
    function saveCart() {
        localStorage.setItem("cart", JSON.stringify(cart));
    }

    function updateCartCount() {
        cartCount.textContent = `üõí –ö–æ—Ä–∑–∏–Ω–∞ (${cart.length})`;
    }

    function renderCart() {
        cartItems.innerHTML = "";
        let total = 0;

        cart.forEach((item, i) => {
            const li = document.createElement("li");
            li.innerHTML = `
                <span>${item.name} ‚Äî ${item.price} ‚ÇΩ</span>
                <button data-index="${i}">‚ùå</button>
            `;
            cartItems.appendChild(li);
            total += item.price;
        });

        if (cart.length > 0) {
            const totalLi = document.createElement("li");
            totalLi.style.fontWeight = "bold";
            totalLi.textContent = `–ò—Ç–æ–≥–æ: ${total} ‚ÇΩ`;
            cartItems.appendChild(totalLi);
        }
    }

    /* ===== ADD TO CART ===== */
    document.querySelector
